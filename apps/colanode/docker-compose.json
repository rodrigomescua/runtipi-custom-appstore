{
  "services": [
    {
      "name": "colanode-postgres",
      "image": "pgvector/pgvector:pg17",
      "environment": {
        "POSTGRES_USER": "colanode_user",
        "POSTGRES_PASSWORD": "postgrespass123",
        "POSTGRES_DB": "colanode_db"
      },
      "internalPort": 5432,
      "volumes": [
        {
          "hostPath": "${APP_DATA_DIR}/data/postgres_data",
          "containerPath": "/var/lib/postgresql/data",
          "readOnly": false,
          "shared": false,
          "private": false
        }
      ]
    },
    {
      "name": "colanode-valkey",
      "image": "valkey/valkey:8.1",
      "command": [
        "valkey-server",
        "--requirepass",
        "your_valkey_password"
      ],
      "internalPort": 6379,
      "volumes": [
        {
          "hostPath": "${APP_DATA_DIR}/data/valkey_data",
          "containerPath": "/data",
          "readOnly": false,
          "shared": false,
          "private": false
        }
      ]
    },
    {
      "name": "colanode-minio",
      "image": "minio/minio:RELEASE.2025-04-08T15-41-24Z",
      "command": "-c 'mkdir -p /data/colanode && minio server /data --address \":9000\" --console-address \":9001\"'",
      "environment": {
        "MINIO_ROOT_USER": "minioadmin",
        "MINIO_ROOT_PASSWORD": "your_minio_password",
        "MINIO_BROWSER": "on",
        "MINIO_DOMAIN": "minio",
        "MINIO_ADDRESS": ":9000",
        "MINIO_CONSOLE_ADDRESS": ":9001"
      },
      "internalPort": 9000,
      "addPorts": [
        {
          "containerPort": 9001,
          "hostPort": 9001,
          "tcp": true,
          "udp": false
        }
      ],
      "volumes": [
        {
          "hostPath": "${APP_DATA_DIR}/data/minio_data",
          "containerPath": "/data",
          "readOnly": false,
          "shared": false,
          "private": false
        }
      ],
      "entrypoint": "sh"
    },
    {
      "name": "colanode-server",
      "image": "ghcr.io/colanode/server:0.3.4",
      "environment": {
        "NODE_ENV": "production",
        "SERVER_NAME": "Colanode Local",
        "SERVER_AVATAR": "",
        "SERVER_MODE": "standalone",
        "ACCOUNT_VERIFICATION_TYPE": "automatic",
        "ACCOUNT_OTP_TIMEOUT": "600",
        "USER_STORAGE_LIMIT": "10737418240",
        "USER_MAX_FILE_SIZE": "104857600",
        "POSTGRES_URL": "postgres://colanode_user:postgrespass123@postgres:5432/colanode_db",
        "REDIS_URL": "redis://:your_valkey_password@colanode-valkey:6379/0",
        "REDIS_DB": "0",
        "STORAGE_S3_ENDPOINT": "http://minio:9000",
        "STORAGE_S3_ACCESS_KEY": "minioadmin",
        "STORAGE_S3_SECRET_KEY": "your_minio_password",
        "STORAGE_S3_BUCKET": "colanode",
        "STORAGE_S3_REGION": "us-east-1",
        "STORAGE_S3_FORCE_PATH_STYLE": "true",
        "SMTP_ENABLED": "false"
      },
      "internalPort": 3000,
      "dependsOn": {
        "colanode-postgres": {
          "condition": "service_started"
        },
        "colanode-valkey": {
          "condition": "service_started"
        },
        "colanode-minio": {
          "condition": "service_started"
        }
      }
    },
    {
      "name": "colanode-web",
      "image": "ghcr.io/colanode/web:0.3.4",
      "internalPort": 80
    }
  ]
}