{
  "$schema": "https://schemas.runtipi.io/v2/dynamic-compose.json",
  "schemaVersion": 2,
  "services": [
    {
      "name": "dispatcharr_db",
      "image": "postgres:14",
      "environment": [
        {
          "key": "POSTGRES_DB",
          "value": "dispatcharr"
        },
        {
          "key": "POSTGRES_USER",
          "value": "dispatch"
        },
        {
          "key": "POSTGRES_PASSWORD",
          "value": "secret"
        }
      ],
      "volumes": [
        {
          "hostPath": "${APP_DATA_DIR}/data/postgres_data",
          "containerPath": "/var/lib/postgresql/data"
        }
      ]
    },
    {
      "name": "dispatcharr_redis",
      "image": "redis:7-alpine"
    },
    {
      "name": "dispatcharr_celery",
      "image": "ghcr.io/dispatcharr/dispatcharr:0.14.0",
      "environment": [
        {
          "key": "POSTGRES_HOST",
          "value": "dispatcharr_db"
        },
        {
          "key": "POSTGRES_DB",
          "value": "dispatcharr"
        },
        {
          "key": "POSTGRES_USER",
          "value": "dispatch"
        },
        {
          "key": "POSTGRES_PASSWORD",
          "value": "secret"
        },
        {
          "key": "REDIS_HOST",
          "value": "dispatcharr_redis"
        },
        {
          "key": "CELERY_BROKER_URL",
          "value": "redis://dispatcharr_redis:6379/0"
        }
      ]
    },
    {
      "name": "dispatcharr",
      "image": "ghcr.io/dispatcharr/dispatcharr:0.14.0",
      "isMain": true,
      "internalPort": 9191,
      "environment": [
        {
          "key": "POSTGRES_HOST",
          "value": "dispatcharr_db"
        },
        {
          "key": "POSTGRES_DB",
          "value": "dispatcharr"
        },
        {
          "key": "POSTGRES_USER",
          "value": "dispatch"
        },
        {
          "key": "POSTGRES_PASSWORD",
          "value": "secret"
        },
        {
          "key": "REDIS_HOST",
          "value": "dispatcharr_redis"
        },
        {
          "key": "CELERY_BROKER_URL",
          "value": "redis://dispatcharr_redis:6379/0"
        },
        {
          "key": "DISPATCHARR_LOG_LEVEL",
          "value": "info"
        },
        {
          "key": "TZ",
          "value": "${TZ}"
        }
      ],
      "volumes": [
        {
          "hostPath": "${APP_DATA_DIR}/data/data",
          "containerPath": "/data"
        }
      ],
      "devices": [
        "/dev/dri:/dev/dri"
      ]
    }
  ]
}
